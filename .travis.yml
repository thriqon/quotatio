
language: node_js
nodejs:
  - "0.10"

before_install:
  - npm install -g bower ember-cli
  - "export DISPLAY=:99.0"
  - "sh -e /etc/init.d/xvfb start"
  - bower install

after_success:
  - ember build --environment production
  - git config --global user.email "travis@travis-ci.org"
  - git config --global user.name "Travis CI"
  - echo "Host 5apps.com" >> ~/.ssh/config
  - echo "StrictHostKeyChecking no" >> ~/.ssh/config
  - echo "UserKnownHostsFile=/dev/null" >> ~/.ssh/config
  - openssl aes-256-cbc -pass "pass:"$PASSCODE -in 5apps.key.enc -out ~/.ssh/id_rsa -d -a
  - chmod 0600 ~/.ssh/id_rsa
  - git add -f dist
  - git commit -m built_$TRAVIS_COMMIT
  - echo "On branch" $TRAVIS_BRANCH
  - if [ "x"$TRAVIS_BRANCH = "xmaster" ]; then git subtree push --prefix=dist git@5apps.com:thriqon_quotatio.git master ; fi


secure: "Im+ugi5jUZI/xCjL2JPkTE9FVma+FQcBC1h3znTo36tvmApK3O7fkqw2efYiatGNt/+5Hws2ch0/XrnlIWEtn34+uBH3lgJpzyPDJc/XLVsZ6lADMCqMhc6C6p1XlklPfcHCSWW5r6BfEA6B71g8b3oKdrpv5KPQqO+FFmIgnJg="
